(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/takePhotos/takePhotos"],{1683:function(e,a,t){"use strict";var i,n=function(){var e=this,a=e.$createElement;e._self._c},o=[];t.d(a,"b",function(){return n}),t.d(a,"c",function(){return o}),t.d(a,"a",function(){return i})},"3c52":function(e,a,t){"use strict";t.r(a);var i=t("1683"),n=t("c51c");for(var o in n)"default"!==o&&function(e){t.d(a,e,function(){return n[e]})}(o);t("3f6e");var r,c=t("f0c5"),s=Object(c["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],r);a["default"]=s.exports},"3f6e":function(e,a,t){"use strict";var i=t("aff3"),n=t.n(i);n.a},"943a":function(e,a,t){"use strict";(function(e){t("7ad1"),t("921b");i(t("66fd"));var a=i(t("3c52"));function i(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,t("543d")["createPage"])},aff3:function(e,a,t){},b87e:function(e,a,t){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=function(){return t.e("components/uni-popup/uni-popup").then(t.bind(null,"593e"))},n=function(){return t.e("components/form").then(t.bind(null,"19aa"))},o={name:"idCardInfoCollect",components:{uniPopup:i,bxform:n},data:function(){return{addType:"",showCamera:!0,tempFilePath:"",beforeImg:"",previewImg:"",compressImg:"",afterImg:"",fileList:[],picList:[],responseList:[],dept_no:"",formData:{name:"",id_card_addr:"",id_card_no:"",profile_picture:"",car_photo:"",car_no:""}}},onLoad:function(e){console.log("photo-option",e),e.dept_no&&(this.dept_no=e.dept_no),e.addType&&(this.addType=e.addType)},methods:{toForm:function(){var a=this.formData;"car"===this.addType?e.redirectTo({url:"../checkInCarInfo/checkInCarInfo?formData="+encodeURIComponent(JSON.stringify(a))+"&dept_no="+this.dept_no}):e.redirectTo({url:"../checkInPersonInfo/checkInPersonInfo?formData="+encodeURIComponent(JSON.stringify(a))+"&dept_no="+this.dept_no})},getPreviewPic:function(){var a=this,t=this.beforeImg,i=a.$api.upload;if("car"===a.addType){var n=e.createCanvasContext("previewCarCanvas",this);n.drawImage(t,0,0,688,1024),n.draw(!1,function(t){a.fileList=[],a.picList=[],a.responseList=[],e.canvasToTempFilePath({x:0,y:0,width:688,height:1024,destWidth:688,destHeight:1024,fileType:"jpg",canvasId:"previewCarCanvas",success:function(t){a.previewImg=t.tempFilePath,console.log("car-preview",t.tempFilePath),e.uploadFile({url:i,filePath:t.tempFilePath,name:"file",header:{bx_auth_ticket:a.$api.onTicket?a.$api.ticket:e.getStorageSync("bx_auth_ticket")},formData:{serviceName:"srv_bxfile_service",interfaceName:"add",app_no:"daq",table_name:"bxdaq_check_car",columns:"car_photo"},success:function(e){var t=JSON.parse(e.data);a.formData.car_photo=t.file_no}})}})})}else{var o=e.createCanvasContext("previewCanvas",this);o.translate(0,250),o.rotate(270*Math.PI/180),o.drawImage(t,0,0,250,375),o.draw(!1,function(t){a.fileList=[],a.picList=[],a.responseList=[],e.canvasToTempFilePath({x:0,y:0,width:375,height:250,destWidth:375,destHeight:250,fileType:"jpg",canvasId:"previewCanvas",success:function(t){a.previewImg=t.tempFilePath,console.log(a.previewImg),e.uploadFile({url:i,filePath:t.tempFilePath,name:"file",header:{bx_auth_ticket:a.$api.onTicket?a.$api.ticket:e.getStorageSync("bx_auth_ticket")},formData:{serviceName:"srv_bxfile_service",interfaceName:"add",app_no:"daq",table_name:"bxdaq_check_car",columns:"car_photo"},success:function(e){var t=JSON.parse(e.data);a.formData.id_card_photo=t.file_no}})}})})}},clipImages:function(){e.showLoading({title:"正在识别..."});var a=this;if("person"===this.addType){var t=e.createCanvasContext("firstCanvas",this);t.drawImage(a.previewImg,75,35,160,45,0,0,160,45),t.draw(!1,function(e){var t={width:160,height:40,id:"firstCanvas",label:"name"};a.getImg(t)});var i=e.createCanvasContext("profileCanvas",this);i.drawImage(a.previewImg,225,35,110,145,0,0,110,145),i.draw(!1,function(e){var t={width:110,height:145,id:"profileCanvas",label:"profile_picture"};a.getImg(t)});var n=e.createCanvasContext("secondCanvas",this);n.drawImage(a.previewImg,75,110,170,70,0,0,170,70),n.draw(!1,function(e){var t={width:170,height:70,id:"secondCanvas",label:"id_card_addr"};a.getImg(t)});var o=e.createCanvasContext("thirdCanvas",this);o.drawImage(a.previewImg,130,160,235,70,0,0,235,70),o.draw(!1,function(e){var t={width:235,height:40,id:"thirdCanvas",label:"id_card_no"};a.getImg(t)})}else if("car"===this.addType){var r=e.createCanvasContext("carCandCanvas",this);r.drawImage(a.previewImg,190,637,317,107,0,0,318,107),r.draw(!1,function(e){var t={width:307,height:105,id:"carCandCanvas",label:"car_no"};a.getImg(t)})}},getImg:function(a){var t=this,i=this;e.canvasToTempFilePath({x:0,y:0,width:a.width,height:a.height,destWidth:a.width,destHeight:a.height,canvasId:a.id,success:function(n){i.picList.push(n.tempFilePath);var o=i.$api.upload;console.log(n.tempFilePath),e.uploadFile({url:o,filePath:n.tempFilePath,name:"file",header:{bx_auth_ticket:i.$api.onTicket?i.$api.ticket:e.getStorageSync("bx_auth_ticket")},formData:{serviceName:"srv_bxfile_service",interfaceName:"add",app_no:"daq",table_name:"bxdaq_check_car",columns:"car_photo"},success:function(n){var o=JSON.parse(n.data);"profile_picture"===a.label&&(console.log("profile_picture",o),i.formData.profile_picture=o.file_no),i.fileList.push(o.file_no),i.responseList.push({file_no:o.file_no,label:a.label,content:""});var r=i.getServiceUrl("daq","srvdaq_orc_text_extraction","operate"),c=[{serviceName:"srvdaq_orc_text_extraction",data:[{file_no:o.file_no}]}];i.$http.post(r,c).then(function(n){if("SUCCESS"===n.data.state){var o=i.responseList,r=n.data.response[0].response;r&&(o.map(function(n){r[n.file_no]&&(n["value"]=r[n.file_no],console.log(n),i.$set(i.formData,a.label,r[n.file_no]),console.log(t.formData),e.hideLoading())}),console.log(n.data.response[0].response)),console.log(n.data.response)}else console.log(n.data.resultMessage)})}})}})},toCarema:function(){this.formData={name:"",id_card_addr:"",id_card_no:""},this.showCamera=!0},takePhoto:function(){var a=this,t=e.createCameraContext();t.takePhoto({quality:"high",success:function(e){a.beforeImg=e.tempImagePath,a.showCamera=!1,a.getPreviewPic()}})},error:function(e){console.log(e.detail)}}};a.default=o}).call(this,t("543d")["default"])},c51c:function(e,a,t){"use strict";t.r(a);var i=t("b87e"),n=t.n(i);for(var o in i)"default"!==o&&function(e){t.d(a,e,function(){return i[e]})}(o);a["default"]=n.a}},[["943a","common/runtime","common/vendor"]]]);